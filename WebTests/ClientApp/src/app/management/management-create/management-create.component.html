<h2>Создание теста</h2>
<br />

<input
       type="text"
       name="test-title"
       [(ngModel)]="test.title"
       [readonly]="is_editing_locked"
       placeholder="Название теста" />


<label>
  <input type="checkbox"
         [(ngModel)]="test.published"
         [disabled]="is_editing_locked" />
  Опубликовать тест
</label>


<p>{{ text_error }}</p>


<div *ngFor="let question of test.questions; let i = index">
  <h3>Вопрос {{ i + 1 }}</h3>
  <input
         type="text"
         [(ngModel)]="question.text"
         [readonly]="is_editing_locked"
         placeholder="Текст вопроса" />

  <ul>
    <li *ngFor="let option of question.options; let j = index">
      <input type="radio"
             [name]="'correct_' + i"
             [checked]="option.isCorrect"
             [disabled]="is_editing_locked"
             (change)="selectCorrectOption(question, j)"/>

      <input
             type="text"
             [(ngModel)]="option.text"
             [readonly]="is_editing_locked"
             placeholder="Вариант {{ j + 1 }}" />

      <button type="button" [disabled]="is_editing_locked" (click)="removeOption(question, j)">Удалить</button>
    </li>
  </ul>

  <button type="button"
          [disabled]="is_editing_locked"
          (click)="addOption(question)">Добавить вариант</button>

  <button type="button"
          [disabled]="is_editing_locked"
          (click)="removeQuestion(i)">Удалить вопрос</button>
  <br />
</div>

<br />
<button type="button"
        [disabled]="is_editing_locked"
        (click)="addQuestion()">Добавить вопрос</button>

<br />
<div *ngIf="test.questions.length > 2 and test_title != ''">
  <button type="button"
          [disabled]="is_editing_locked"
          (click)="btnAdd()">Добавить тест</button>
</div>

<div *ngIf="confirm_add">
  <p>Подтвердите добавление теста {{ test.title }}</p>
  <button type="button" (click)="btnConfirm()">Подтвердить</button>
  <button type="button" (click)="btnCancel()">Отменить</button>
</div>

<div *ngIf="success_add">
  <p>Тест успешно добавлен!</p>
</div>


<!--<div *ngIf="json_add == false; else ">-->
<button type="button"
        (click)="json_add = true">
  Добавить с помощью JSON
  </button>
<!--</div>-->


<div *ngIf="json_add">
  <textarea [(ngModel)]="json_input" placeholder='{
    "title": "Название",
    "questions": [
        {
            "text": "Вопрос?",
            "options": [
                {
                    "text": "Правильный вариант ответа",
                    "isCorrect": true
                },
                {
                    "text": "Неправильный вариант ответа",
                    "isCorrect": false
                }
            ]
        }
    ]
}'></textarea>
  <button type="button" (click)="loadFromJson()">Импортировать JSON</button>
  <p>{{ json_error }}</p>
</div>
